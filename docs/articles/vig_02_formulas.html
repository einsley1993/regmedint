<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Implementation of formulas â€¢ regmedint</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Implementation of formulas">
<meta property="og:description" content="regmedint">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">regmedint</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vig_01_introduction.html">Introduction to user interface functions</a>
    </li>
    <li>
      <a href="../articles/vig_02_formulas.html">Implementation of formulas</a>
    </li>
    <li>
      <a href="../articles/vig_03_bootstrap.html">Using bootstrapping with regemedint</a>
    </li>
    <li>
      <a href="../articles/vig_04_mi.html">Using multiple imputation with regmedint</a>
    </li>
    <li>
      <a href="../articles/vig_05_emm.html">Implementation of extended formulas when there are effect measure modifiers</a>
    </li>
    <li>
      <a href="../articles/vig_06_delta_boot.html">Validation of extended formuals with effect modification using bootstrap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kaz-yos/regmedint" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Implementation of formulas</h1>
                        <h4 data-toc-skip class="author">Kazuki Yoshida</h4>
            
            <h4 data-toc-skip class="date">2022-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kaz-yos/regmedint/blob/HEAD/vignettes/vig_02_formulas.Rmd" class="external-link"><code>vignettes/vig_02_formulas.Rmd</code></a></small>
      <div class="hidden name"><code>vig_02_formulas.Rmd</code></div>

    </div>

    
    
<p>The bodies of the following functions contain the R implementation of the formulas in V2015. Although many models are covered, there are only four patterns. See the package top page for further references. The code seen here is compacted and lacks the comments. For more redable code, please refer to the <a href="https://github.com/kaz-yos/regmedint" class="external-link">Github repo</a> and search for the function names without the preceding <code>regmedint:::</code>. For the type-set mathematical expressions and LaTeX source, please see the <a href="https://github.com/kaz-yos/regmedint-supplement/blob/master/supplement.pdf" class="external-link">supplement</a>.</p>
<div class="section level2">
<h2 id="mreg-linear-yreg-linear-v2015-p466-proposition-2-3">mreg linear yreg linear (V2015 p466 Proposition 2.3)<a class="anchor" aria-label="anchor" href="#mreg-linear-yreg-linear-v2015-p466-proposition-2-3"></a>
</h2>
<p>These functions are only used in the setting where both the mediator model and the outcome model are linear regression.</p>
<div class="section level3">
<h3 id="point-estimates">Point estimates<a class="anchor" aria-label="anchor" href="#point-estimates"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_linear_yreg_linear_est</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6)</span>
<span class="co">##     fun_est &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         cde &lt;- (theta1 + theta3 * m_cde + theta5_c) * (a1 - a0)</span>
<span class="co">##         pnde &lt;- (theta1 + theta3 * (beta0 + beta1 * a0 + beta2_c + </span>
<span class="co">##             beta3_c * a0) + theta5_c) * (a1 - a0)</span>
<span class="co">##         tnie &lt;- (theta2 + theta3 * a1 + theta6_c) * (beta1 + </span>
<span class="co">##             beta3_c) * (a1 - a0)</span>
<span class="co">##         tnde &lt;- (theta1 + theta3 * (beta0 + beta1 * a1 + beta2_c + </span>
<span class="co">##             beta3_c * a1) + theta5_c) * (a1 - a0)</span>
<span class="co">##         pnie &lt;- (theta2 + theta3 * a0 + theta6_c) * (beta1 + </span>
<span class="co">##             beta3_c) * (a1 - a0)</span>
<span class="co">##         te &lt;- pnde + tnie</span>
<span class="co">##         pm &lt;- tnie/te</span>
<span class="co">##         c(cde = unname(cde), pnde = unname(pnde), tnie = unname(tnie), </span>
<span class="co">##             tnde = unname(tnde), pnie = unname(pnie), te = unname(te), </span>
<span class="co">##             pm = unname(pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_est)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc41d39b70&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
<div class="section level3">
<h3 id="standard-error-estimates">Standard error estimates<a class="anchor" aria-label="anchor" href="#standard-error-estimates"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_linear_yreg_linear_se</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6, Sigma_beta, Sigma_theta) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6)</span>
<span class="co">##     validate_myreg_vcovs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6, </span>
<span class="co">##         Sigma_beta = Sigma_beta, Sigma_theta = Sigma_theta)</span>
<span class="co">##     Sigma &lt;- Matrix::bdiag(Sigma_beta, Sigma_theta)</span>
<span class="co">##     fun_se &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_cde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_cde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_cde &lt;- matrix(c(0, 0, rep(0, length(beta2)), rep(0, </span>
<span class="co">##             length(beta3)), 0, 1, 0, m_cde, rep(0, length(theta4)), </span>
<span class="co">##             pd_cde_theta5, rep(0, length(theta6))))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_pnde_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnde_beta3 &lt;- theta3 * c_cond</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_pnde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnde &lt;- matrix(c(theta3, theta3 * a0, theta3 * </span>
<span class="co">##             c_cond, pd_pnde_beta3, 0, 1, 0, beta0 + beta1 * a0 + </span>
<span class="co">##             beta2_c + beta3_c * a0, rep(0, length(theta4)), pd_pnde_theta5, </span>
<span class="co">##             rep(0, length(theta6))))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_tnie_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnie_beta3 &lt;- c_cond * (theta2 + theta3 * a1 + </span>
<span class="co">##                 theta6_c)</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pd_tnie_theta6 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnie_theta6 &lt;- c_cond * (beta1 + beta3_c)</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnie &lt;- matrix(c(0, theta2 + theta3 * a1 + theta6_c, </span>
<span class="co">##             rep(0, length(beta2)), pd_tnie_beta3, 0, 0, beta1 + </span>
<span class="co">##                 beta3_c, a1 * (beta1 + beta3_c), rep(0, length(theta4)), </span>
<span class="co">##             rep(0, length(theta5)), pd_tnie_theta6))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_tnde_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnde_beta3 &lt;- theta3 * a1 * c_cond</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_tnde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnde &lt;- matrix(c(theta3, theta3 * a1, theta3 * </span>
<span class="co">##             c_cond, pd_tnde_beta3, 0, 1, 0, beta0 + beta1 * a1 + </span>
<span class="co">##             beta2_c + beta3_c * a1, rep(0, length(theta4)), pd_tnde_theta5, </span>
<span class="co">##             rep(0, length(theta6))))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_pnie_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnie_beta3 &lt;- c_cond * (theta2 + theta3 * a0 + </span>
<span class="co">##                 theta6_c)</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pd_pnie_theta6 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnie_theta6 &lt;- c_cond * (beta1 + beta3_c)</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnie &lt;- matrix(c(0, theta2 + theta3 * a0 + theta6_c, </span>
<span class="co">##             rep(0, length(beta2)), pd_pnie_beta3, 0, 0, beta1 + </span>
<span class="co">##                 beta3_c, a0 * (beta1 + beta3_c), rep(0, length(theta4)), </span>
<span class="co">##             rep(0, length(theta5)), pd_pnie_theta6))</span>
<span class="co">##         Gamma_te &lt;- Gamma_pnde + Gamma_tnie</span>
<span class="co">##         pnde &lt;- (theta1 + theta3 * (beta0 + beta1 * a0 + beta2_c + </span>
<span class="co">##             beta3_c * a0) + theta5_c) * (a1 - a0)</span>
<span class="co">##         tnie &lt;- (theta2 + theta3 * a1 + theta6_c) * (beta1 + </span>
<span class="co">##             beta3_c) * (a1 - a0)</span>
<span class="co">##         d_pm &lt;- grad_prop_med_yreg_linear(pnde = unname(pnde), </span>
<span class="co">##             tnie = unname(tnie))</span>
<span class="co">##         Gamma_pm &lt;- (d_pm[["pnde"]] * Gamma_pnde) + (d_pm[["tnie"]] * </span>
<span class="co">##             Gamma_tnie)</span>
<span class="co">##         a1_sub_a0 &lt;- abs(a1 - a0)</span>
<span class="co">##         se_cde &lt;- sqrt(as.numeric(t(Gamma_cde) %*% Sigma %*% </span>
<span class="co">##             Gamma_cde)) * a1_sub_a0</span>
<span class="co">##         se_pnde &lt;- sqrt(as.numeric(t(Gamma_pnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnde)) * a1_sub_a0</span>
<span class="co">##         se_tnie &lt;- sqrt(as.numeric(t(Gamma_tnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnie)) * a1_sub_a0</span>
<span class="co">##         se_tnde &lt;- sqrt(as.numeric(t(Gamma_tnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnde)) * a1_sub_a0</span>
<span class="co">##         se_pnie &lt;- sqrt(as.numeric(t(Gamma_pnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnie)) * a1_sub_a0</span>
<span class="co">##         se_te &lt;- sqrt(as.numeric(t(Gamma_te) %*% Sigma %*% Gamma_te)) * </span>
<span class="co">##             a1_sub_a0</span>
<span class="co">##         se_pm &lt;- sqrt(as.numeric(t(Gamma_pm) %*% Sigma %*% Gamma_pm)) * </span>
<span class="co">##             a1_sub_a0</span>
<span class="co">##         c(se_cde = unname(se_cde), se_pnde = unname(se_pnde), </span>
<span class="co">##             se_tnie = unname(se_tnie), se_tnde = unname(se_tnde), </span>
<span class="co">##             se_pnie = unname(se_pnie), se_te = unname(se_te), </span>
<span class="co">##             se_pm = unname(se_pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_se)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc3ef19e90&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="mreg-linear-yreg-non-linear-v2015-p468-proposition-2-4">mreg linear yreg non-linear (V2015 p468 Proposition 2.4)<a class="anchor" aria-label="anchor" href="#mreg-linear-yreg-non-linear-v2015-p468-proposition-2-4"></a>
</h2>
<p>These functions are used in all cases where the mediator model is linear regression and the outcome model is any one of the non-linear models.</p>
<div class="section level3">
<h3 id="point-estimates-1">Point estimates<a class="anchor" aria-label="anchor" href="#point-estimates-1"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_linear_yreg_logistic_est</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6, sigma_sq) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6, </span>
<span class="co">##         sigma_sq = sigma_sq)</span>
<span class="co">##     fun_est &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         cde &lt;- (theta1 + theta3 * m_cde + theta5_c) * (a1 - a0)</span>
<span class="co">##         pnde &lt;- ((theta1 + theta5_c + theta3 * (beta0 + beta1 * </span>
<span class="co">##             a0 + beta2_c + beta3_c * a0) + 1/2 * sigma_sq * theta3 * </span>
<span class="co">##             (2 * theta2 + theta3 * a1 + theta3 * a0 + 2 * theta6_c))) * </span>
<span class="co">##             (a1 - a0)</span>
<span class="co">##         tnie &lt;- (theta2 + theta3 * a1 + theta6_c) * (beta1 + </span>
<span class="co">##             beta3_c) * (a1 - a0)</span>
<span class="co">##         tnde &lt;- ((theta1 + theta5_c + theta3 * (beta0 + beta1 * </span>
<span class="co">##             a1 + beta2_c + beta3_c * a1) + 1/2 * sigma_sq * theta3 * </span>
<span class="co">##             (2 * theta2 + theta3 * a1 + theta3 * a0 + 2 * theta6_c))) * </span>
<span class="co">##             (a1 - a0)</span>
<span class="co">##         pnie &lt;- (theta2 + theta3 * a0 + theta6_c) * (beta1 + </span>
<span class="co">##             beta3_c) * (a1 - a0)</span>
<span class="co">##         te &lt;- pnde + tnie</span>
<span class="co">##         pm &lt;- exp(pnde) * (exp(tnie) - 1)/(exp(te) - 1)</span>
<span class="co">##         c(cde = unname(cde), pnde = unname(pnde), tnie = unname(tnie), </span>
<span class="co">##             tnde = unname(tnde), pnie = unname(pnie), te = unname(te), </span>
<span class="co">##             pm = unname(pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_est)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc230cc2b0&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
<div class="section level3">
<h3 id="standard-error-estimates-1">Standard error estimates<a class="anchor" aria-label="anchor" href="#standard-error-estimates-1"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_linear_yreg_logistic_se</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6, sigma_sq, Sigma_beta, Sigma_theta, </span>
<span class="co">##     Sigma_sigma_sq) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6, </span>
<span class="co">##         sigma_sq = sigma_sq)</span>
<span class="co">##     validate_myreg_vcovs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6, </span>
<span class="co">##         sigma_sq = sigma_sq, Sigma_beta = Sigma_beta, Sigma_theta = Sigma_theta, </span>
<span class="co">##         Sigma_sigma_sq = Sigma_sigma_sq)</span>
<span class="co">##     Sigma &lt;- Matrix::bdiag(Sigma_beta, Sigma_theta, Sigma_sigma_sq)</span>
<span class="co">##     fun_se &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_cde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_cde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_cde &lt;- matrix(c(0, 0, rep(0, length(beta2)), rep(0, </span>
<span class="co">##             length(beta3)), 0, 1, 0, m_cde, rep(0, length(theta4)), </span>
<span class="co">##             pd_cde_theta5, rep(0, length(theta6)), 0))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_pnde_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnde_beta3 &lt;- theta3 * a1 * c_cond</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_pnde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pd_pnde_theta6 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnde_theta6 &lt;- theta3 * sigma_sq * c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnde &lt;- matrix(c(theta3, theta3 * a0, theta3 * </span>
<span class="co">##             c_cond, pd_pnde_beta3, 0, 1, theta3 * sigma_sq, a0 * </span>
<span class="co">##             (beta1 + beta3_c) + beta0 + beta2_c + sigma_sq * </span>
<span class="co">##             ((theta2 + theta6_c) + theta3 * (a0 + a1)), rep(0, </span>
<span class="co">##             length(theta4)), pd_pnde_theta5, pd_pnde_theta6, </span>
<span class="co">##             1/2 * theta3 * (2 * (theta2 + theta6_c) + theta3 * </span>
<span class="co">##                 (a0 + a1))))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_tnie_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnie_beta3 &lt;- c_cond * (theta2 + theta3 * a1 + </span>
<span class="co">##                 theta6_c)</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pd_tnie_theta6 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnie_theta6 &lt;- c_cond * (beta1 + beta3_c)</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnie &lt;- matrix(c(0, theta2 + theta3 * a1 + theta6_c, </span>
<span class="co">##             rep(0, length(beta2)), pd_tnie_beta3, 0, 0, beta1 + </span>
<span class="co">##                 beta3_c, a1 * (beta1 + beta3_c), rep(0, length(theta4)), </span>
<span class="co">##             rep(0, length(theta5)), pd_tnie_theta6, 0))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_tnde_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnde_beta3 &lt;- theta3 * a1 * c_cond</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_tnde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pd_tnde_theta6 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_tnde_theta6 &lt;- theta3 * sigma_sq * c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnde &lt;- matrix(c(theta3, theta3 * a1, theta3 * </span>
<span class="co">##             c_cond, pd_tnde_beta3, 0, 1, theta3 * sigma_sq, a1 * </span>
<span class="co">##             (beta1 + beta3_c) + beta0 + beta2_c + sigma_sq * </span>
<span class="co">##             ((theta2 + theta6_c) + theta3 * (a0 + a1)), rep(0, </span>
<span class="co">##             length(theta4)), pd_tnde_theta5, pd_tnde_theta6, </span>
<span class="co">##             1/2 * theta3 * (2 * (theta2 + theta6_c) + theta3 * </span>
<span class="co">##                 (a0 + a1))))</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pd_pnie_beta3 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnie_beta3 &lt;- c_cond * (theta2 + theta3 * a0 + </span>
<span class="co">##                 theta6_c)</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pd_pnie_theta6 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_pnie_theta6 &lt;- c_cond * (beta1 + beta3_c)</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnie &lt;- matrix(c(0, theta2 + theta3 * a0 + theta6_c, </span>
<span class="co">##             rep(0, length(beta2)), pd_pnie_beta3, 0, 0, beta1 + </span>
<span class="co">##                 beta3_c, a0 * (beta1 + beta3_c), rep(0, length(theta4)), </span>
<span class="co">##             rep(0, length(theta5)), pd_pnie_theta6, 0))</span>
<span class="co">##         Gamma_te &lt;- Gamma_pnde + Gamma_tnie</span>
<span class="co">##         pnde &lt;- ((theta1 + theta5_c + theta3 * (beta0 + beta1 * </span>
<span class="co">##             a0 + beta2_c + beta3_c * a0) + 1/2 * sigma_sq * theta3 * </span>
<span class="co">##             (2 * theta2 + theta3 * a1 + theta3 * a0 + 2 * theta6_c))) * </span>
<span class="co">##             (a1 - a0)</span>
<span class="co">##         tnie &lt;- (theta2 + theta3 * a1 + theta6_c) * (beta1 + </span>
<span class="co">##             beta3_c) * (a1 - a0)</span>
<span class="co">##         d_pm &lt;- grad_prop_med_yreg_logistic(pnde = unname(pnde), </span>
<span class="co">##             tnie = unname(tnie))</span>
<span class="co">##         Gamma_pm &lt;- d_pm[["pnde"]] * Gamma_pnde + d_pm[["tnie"]] * </span>
<span class="co">##             Gamma_tnie</span>
<span class="co">##         a1_sub_a0 &lt;- abs(a1 - a0)</span>
<span class="co">##         se_cde &lt;- sqrt(as.numeric(t(Gamma_cde) %*% Sigma %*% </span>
<span class="co">##             Gamma_cde)) * a1_sub_a0</span>
<span class="co">##         se_pnde &lt;- sqrt(as.numeric(t(Gamma_pnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnde)) * a1_sub_a0</span>
<span class="co">##         se_tnie &lt;- sqrt(as.numeric(t(Gamma_tnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnie)) * a1_sub_a0</span>
<span class="co">##         se_tnde &lt;- sqrt(as.numeric(t(Gamma_tnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnde)) * a1_sub_a0</span>
<span class="co">##         se_pnie &lt;- sqrt(as.numeric(t(Gamma_pnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnie)) * a1_sub_a0</span>
<span class="co">##         se_te &lt;- sqrt(as.numeric(t(Gamma_te) %*% Sigma %*% Gamma_te)) * </span>
<span class="co">##             a1_sub_a0</span>
<span class="co">##         se_pm &lt;- sqrt(as.numeric(t(Gamma_pm) %*% Sigma %*% Gamma_pm)) * </span>
<span class="co">##             a1_sub_a0</span>
<span class="co">##         c(se_cde = unname(se_cde), se_pnde = unname(se_pnde), </span>
<span class="co">##             se_tnie = unname(se_tnie), se_tnde = unname(se_tnde), </span>
<span class="co">##             se_pnie = unname(se_pnie), se_te = unname(se_te), </span>
<span class="co">##             se_pm = unname(se_pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_se)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc34929018&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="mreg-logistic-yreg-linear-v2015-p471-proposition-2-5">mreg logistic yreg linear (V2015 p471 Proposition 2.5)<a class="anchor" aria-label="anchor" href="#mreg-logistic-yreg-linear-v2015-p471-proposition-2-5"></a>
</h2>
<p>These functions are only used in the setting where the mediator model is logistic regression and the outcome model is non-linear regression.</p>
<div class="section level3">
<h3 id="point-estimates-2">Point estimates<a class="anchor" aria-label="anchor" href="#point-estimates-2"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_logistic_yreg_linear_est</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6)</span>
<span class="co">##     fun_est &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         expit &lt;- function(x) {</span>
<span class="co">##             exp(x)/(1 + exp(x))</span>
<span class="co">##         }</span>
<span class="co">##         cde &lt;- (theta1 + theta3 * m_cde + theta5_c) * (a1 - a0)</span>
<span class="co">##         pnde &lt;- (theta1 + theta3 * expit(beta0 + beta1 * a0 + </span>
<span class="co">##             beta2_c + beta3_c * a0) + theta5_c) * (a1 - a0)</span>
<span class="co">##         tnie &lt;- (theta2 + theta3 * a1 + theta6_c) * (expit(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1) - expit(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0))</span>
<span class="co">##         tnde &lt;- (theta1 + theta3 * expit(beta0 + beta1 * a1 + </span>
<span class="co">##             beta2_c + beta3_c * a1) + theta5_c) * (a1 - a0)</span>
<span class="co">##         pnie &lt;- (theta2 + theta3 * a0 + theta6_c) * (expit(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1) - expit(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0))</span>
<span class="co">##         te &lt;- pnde + tnie</span>
<span class="co">##         pm &lt;- tnie/te</span>
<span class="co">##         c(cde = unname(cde), pnde = unname(pnde), tnie = unname(tnie), </span>
<span class="co">##             tnde = unname(tnde), pnie = unname(pnie), te = unname(te), </span>
<span class="co">##             pm = unname(pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_est)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc40cff400&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
<div class="section level3">
<h3 id="standard-error-estimates-2">Standard error estimates<a class="anchor" aria-label="anchor" href="#standard-error-estimates-2"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_logistic_yreg_linear_se</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6, Sigma_beta, Sigma_theta) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6)</span>
<span class="co">##     validate_myreg_vcovs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6, </span>
<span class="co">##         Sigma_beta = Sigma_beta, Sigma_theta = Sigma_theta)</span>
<span class="co">##     Sigma &lt;- Matrix::bdiag(Sigma_beta, Sigma_theta)</span>
<span class="co">##     fun_se &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         expit &lt;- function(x) {</span>
<span class="co">##             exp(x)/(1 + exp(x))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_cde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_cde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_cde &lt;- matrix(c(0, 0, rep(0, length(beta2)), rep(0, </span>
<span class="co">##             length(beta3)), 0, 1, 0, m_cde, rep(0, length(theta4)), </span>
<span class="co">##             pd_cde_theta5, rep(0, length(theta6))))</span>
<span class="co">##         .e3 &lt;- a0 * (beta1 + beta3_c) + beta0 + beta2_c</span>
<span class="co">##         .e4 &lt;- exp(.e3)</span>
<span class="co">##         .e5 &lt;- 1 + .e4</span>
<span class="co">##         .e6 &lt;- 1 - .e4/.e5</span>
<span class="co">##         pnde_d1 &lt;- theta3 * .e6 * .e4/.e5</span>
<span class="co">##         pnde_d2 &lt;- a0 * theta3 * .e6 * .e4/.e5</span>
<span class="co">##         pnde_d3 &lt;- c_cond * theta3 * .e6 * .e4/.e5</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pnde_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnde_d4 &lt;- a0 * c_cond * theta3 * .e6 * .e4/.e5</span>
<span class="co">##         }</span>
<span class="co">##         pnde_d5 &lt;- 0</span>
<span class="co">##         pnde_d6 &lt;- 1</span>
<span class="co">##         pnde_d7 &lt;- 0</span>
<span class="co">##         pnde_d8 &lt;- expit(.e3)</span>
<span class="co">##         pnde_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pnde_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnde_d10 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         pnde_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         Gamma_pnde &lt;- matrix(c(pnde_d1, pnde_d2, pnde_d3, pnde_d4, </span>
<span class="co">##             pnde_d5, pnde_d6, pnde_d7, pnde_d8, pnde_d9, pnde_d10, </span>
<span class="co">##             pnde_d11))</span>
<span class="co">##         .e1 &lt;- beta1 + beta3_c</span>
<span class="co">##         .e2 &lt;- beta2_c</span>
<span class="co">##         .e5 &lt;- a0 * .e1 + beta0 + .e2</span>
<span class="co">##         .e8 &lt;- a1 * .e1 + beta0 + .e2</span>
<span class="co">##         .e9 &lt;- exp(.e5)</span>
<span class="co">##         .e10 &lt;- exp(.e8)</span>
<span class="co">##         .e11 &lt;- 1 + .e9</span>
<span class="co">##         .e12 &lt;- 1 + .e10</span>
<span class="co">##         .e13 &lt;- 1 - .e9/.e11</span>
<span class="co">##         .e14 &lt;- 1 - .e10/.e12</span>
<span class="co">##         .e17 &lt;- a1 * theta3 + theta6_c + theta2</span>
<span class="co">##         .e20 &lt;- expit(.e8) - expit(.e5)</span>
<span class="co">##         .e25 &lt;- .e14 * .e10/.e12 - .e13 * .e9/.e11</span>
<span class="co">##         .e32 &lt;- a1 * .e14 * .e10/.e12 - a0 * .e13 * .e9/.e11</span>
<span class="co">##         tnie_d1 &lt;- .e25 * .e17</span>
<span class="co">##         tnie_d2 &lt;- .e32 * .e17</span>
<span class="co">##         tnie_d3 &lt;- c_cond * .e25 * .e17</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             tnie_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnie_d4 &lt;- c_cond * .e32 * .e17</span>
<span class="co">##         }</span>
<span class="co">##         tnie_d5 &lt;- 0</span>
<span class="co">##         tnie_d6 &lt;- 0</span>
<span class="co">##         tnie_d7 &lt;- .e20</span>
<span class="co">##         tnie_d8 &lt;- a1 * .e20</span>
<span class="co">##         tnie_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         tnie_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             tnie_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnie_d11 &lt;- c_cond * .e20</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnie &lt;- matrix(c(tnie_d1, tnie_d2, tnie_d3, tnie_d4, </span>
<span class="co">##             tnie_d5, tnie_d6, tnie_d7, tnie_d8, tnie_d9, tnie_d10, </span>
<span class="co">##             tnie_d11))</span>
<span class="co">##         .e3 &lt;- a1 * (beta1 + beta3_c) + beta0 + beta2_c</span>
<span class="co">##         .e4 &lt;- exp(.e3)</span>
<span class="co">##         .e5 &lt;- 1 + .e4</span>
<span class="co">##         .e6 &lt;- 1 - .e4/.e5</span>
<span class="co">##         tnde_d1 &lt;- theta3 * .e6 * .e4/.e5</span>
<span class="co">##         tnde_d2 &lt;- a1 * theta3 * .e6 * .e4/.e5</span>
<span class="co">##         tnde_d3 &lt;- c_cond * theta3 * .e6 * .e4/.e5</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             tnde_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnde_d4 &lt;- a1 * c_cond * theta3 * .e6 * .e4/.e5</span>
<span class="co">##         }</span>
<span class="co">##         tnde_d5 &lt;- 0</span>
<span class="co">##         tnde_d6 &lt;- 1</span>
<span class="co">##         tnde_d7 &lt;- 0</span>
<span class="co">##         tnde_d8 &lt;- expit(.e3)</span>
<span class="co">##         tnde_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             tnde_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnde_d10 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         tnde_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         Gamma_tnde &lt;- matrix(c(tnde_d1, tnde_d2, tnde_d3, tnde_d4, </span>
<span class="co">##             tnde_d5, tnde_d6, tnde_d7, tnde_d8, tnde_d9, tnde_d10, </span>
<span class="co">##             tnde_d11))</span>
<span class="co">##         .e1 &lt;- beta1 + beta3_c</span>
<span class="co">##         .e2 &lt;- beta2_c</span>
<span class="co">##         .e5 &lt;- a0 * .e1 + beta0 + .e2</span>
<span class="co">##         .e8 &lt;- a1 * .e1 + beta0 + .e2</span>
<span class="co">##         .e9 &lt;- exp(.e5)</span>
<span class="co">##         .e10 &lt;- exp(.e8)</span>
<span class="co">##         .e11 &lt;- 1 + .e9</span>
<span class="co">##         .e12 &lt;- 1 + .e10</span>
<span class="co">##         .e13 &lt;- 1 - .e9/.e11</span>
<span class="co">##         .e14 &lt;- 1 - .e10/.e12</span>
<span class="co">##         .e17 &lt;- a0 * theta3 + theta6_c + theta2</span>
<span class="co">##         .e20 &lt;- expit(.e8) - expit(.e5)</span>
<span class="co">##         .e25 &lt;- .e14 * .e10/.e12 - .e13 * .e9/.e11</span>
<span class="co">##         .e32 &lt;- a1 * .e14 * .e10/.e12 - a0 * .e13 * .e9/.e11</span>
<span class="co">##         pnie_d1 &lt;- .e25 * .e17</span>
<span class="co">##         pnie_d2 &lt;- .e32 * .e17</span>
<span class="co">##         pnie_d3 &lt;- c_cond * .e25 * .e17</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pnie_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnie_d4 &lt;- c_cond * .e32 * .e17</span>
<span class="co">##         }</span>
<span class="co">##         pnie_d5 &lt;- 0</span>
<span class="co">##         pnie_d6 &lt;- 0</span>
<span class="co">##         pnie_d7 &lt;- .e20</span>
<span class="co">##         pnie_d8 &lt;- a0 * .e20</span>
<span class="co">##         pnie_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         pnie_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pnie_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnie_d11 &lt;- c_cond * .e20</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnie &lt;- matrix(c(pnie_d1, pnie_d2, pnie_d3, pnie_d4, </span>
<span class="co">##             pnie_d5, pnie_d6, pnie_d7, pnie_d8, pnie_d9, pnie_d10, </span>
<span class="co">##             pnie_d11))</span>
<span class="co">##         Gamma_te &lt;- ((a1 - a0) * Gamma_pnde) + Gamma_tnie</span>
<span class="co">##         pnde &lt;- (theta1 + theta3 * expit(beta0 + beta1 * a0 + </span>
<span class="co">##             beta2_c + beta3_c * a0) + theta5_c) * (a1 - a0)</span>
<span class="co">##         tnie &lt;- (theta2 + theta3 * a1 + theta6_c) * (expit(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1) - expit(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0))</span>
<span class="co">##         d_pm &lt;- grad_prop_med_yreg_linear(pnde = unname(pnde), </span>
<span class="co">##             tnie = unname(tnie))</span>
<span class="co">##         Gamma_pm &lt;- (d_pm[["pnde"]] * (a1 - a0) * Gamma_pnde) + </span>
<span class="co">##             (d_pm[["tnie"]] * Gamma_tnie)</span>
<span class="co">##         a1_sub_a0 &lt;- abs(a1 - a0)</span>
<span class="co">##         se_cde &lt;- sqrt(as.numeric(t(Gamma_cde) %*% Sigma %*% </span>
<span class="co">##             Gamma_cde)) * a1_sub_a0</span>
<span class="co">##         se_pnde &lt;- sqrt(as.numeric(t(Gamma_pnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnde)) * a1_sub_a0</span>
<span class="co">##         se_tnie &lt;- sqrt(as.numeric(t(Gamma_tnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnie))</span>
<span class="co">##         se_tnde &lt;- sqrt(as.numeric(t(Gamma_tnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnde)) * a1_sub_a0</span>
<span class="co">##         se_pnie &lt;- sqrt(as.numeric(t(Gamma_pnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnie))</span>
<span class="co">##         se_te &lt;- sqrt(as.numeric(t(Gamma_te) %*% Sigma %*% Gamma_te))</span>
<span class="co">##         se_pm &lt;- sqrt(as.numeric(t(Gamma_pm) %*% Sigma %*% Gamma_pm))</span>
<span class="co">##         c(se_cde = unname(se_cde), se_pnde = unname(se_pnde), </span>
<span class="co">##             se_tnie = unname(se_tnie), se_tnde = unname(se_tnde), </span>
<span class="co">##             se_pnie = unname(se_pnie), se_te = unname(se_te), </span>
<span class="co">##             se_pm = unname(se_pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_se)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc40e32358&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="mreg-logistic-yreg-non-linear-v2015-p473-proposition-2-6">mreg logistic yreg non-linear (V2015 p473 Proposition 2.6)<a class="anchor" aria-label="anchor" href="#mreg-logistic-yreg-non-linear-v2015-p473-proposition-2-6"></a>
</h2>
<p>These functions are used in all cases where the mediator model is logistic regression and the outcome model is any one of the non-linear models.</p>
<div class="section level3">
<h3 id="point-estimates-3">Point estimates<a class="anchor" aria-label="anchor" href="#point-estimates-3"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_logistic_yreg_logistic_est</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6)</span>
<span class="co">##     fun_est &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         expit &lt;- function(x) {</span>
<span class="co">##             exp(x)/(1 + exp(x))</span>
<span class="co">##         }</span>
<span class="co">##         cde &lt;- (theta1 + theta3 * m_cde + theta5_c) * (a1 - a0)</span>
<span class="co">##         pnde &lt;- ((theta1 + theta5_c) * (a1 - a0)) + log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0 + theta2 + theta3 * </span>
<span class="co">##             a1 + theta6_c)) - log(1 + exp(beta0 + beta1 * a0 + </span>
<span class="co">##             beta2_c + beta3_c * a0 + theta2 + theta3 * a0 + theta6_c))</span>
<span class="co">##         tnie &lt;- log(1 + exp(beta0 + beta1 * a1 + beta2_c + beta3_c * </span>
<span class="co">##             a1 + theta2 + theta3 * a1 + theta6_c)) - log(1 + </span>
<span class="co">##             exp(beta0 + beta1 * a0 + beta2_c + beta3_c * a0 + </span>
<span class="co">##                 theta2 + theta3 * a1 + theta6_c)) + log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0)) - log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1))</span>
<span class="co">##         tnde &lt;- ((theta1 + theta5_c) * (a1 - a0)) + log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1 + theta2 + theta3 * </span>
<span class="co">##             a1 + theta6_c)) - log(1 + exp(beta0 + beta1 * a1 + </span>
<span class="co">##             beta2_c + beta3_c * a1 + theta2 + theta3 * a0 + theta6_c))</span>
<span class="co">##         pnie &lt;- log(1 + exp(beta0 + beta1 * a1 + beta2_c + beta3_c * </span>
<span class="co">##             a1 + theta2 + theta3 * a0 + theta6_c)) - log(1 + </span>
<span class="co">##             exp(beta0 + beta1 * a0 + beta2_c + beta3_c * a0 + </span>
<span class="co">##                 theta2 + theta3 * a0 + theta6_c)) + log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0)) - log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1))</span>
<span class="co">##         te &lt;- pnde + tnie</span>
<span class="co">##         pm &lt;- (exp(pnde) * (exp(tnie) - 1))/(exp(te) - 1)</span>
<span class="co">##         c(cde = unname(cde), pnde = unname(pnde), tnie = unname(tnie), </span>
<span class="co">##             tnde = unname(tnde), pnie = unname(pnie), te = unname(te), </span>
<span class="co">##             pm = unname(pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_est)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc232a7d98&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
<div class="section level3">
<h3 id="standard-error-estimates-3">Standard error estimates<a class="anchor" aria-label="anchor" href="#standard-error-estimates-3"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">regmedint</span><span class="fu">:::</span><span class="va">calc_myreg_mreg_logistic_yreg_logistic_se</span></code></pre></div>
<pre><code><span class="co">## function (beta0, beta1, beta2, beta3, theta0, theta1, theta2, </span>
<span class="co">##     theta3, theta4, theta5, theta6, Sigma_beta, Sigma_theta) </span>
<span class="co">## {</span>
<span class="co">##     validate_myreg_coefs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6)</span>
<span class="co">##     validate_myreg_vcovs(beta0 = beta0, beta1 = beta1, beta2 = beta2, </span>
<span class="co">##         beta3 = beta3, theta0 = theta0, theta1 = theta1, theta2 = theta2, </span>
<span class="co">##         theta3 = theta3, theta4 = theta4, theta5 = theta5, theta6 = theta6, </span>
<span class="co">##         Sigma_beta = Sigma_beta, Sigma_theta = Sigma_theta)</span>
<span class="co">##     Sigma &lt;- Matrix::bdiag(Sigma_beta, Sigma_theta)</span>
<span class="co">##     fun_se &lt;- function(a0, a1, m_cde, c_cond) {</span>
<span class="co">##         if (is.null(beta2)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             beta2_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta2))</span>
<span class="co">##             beta2_c &lt;- sum(t(matrix(beta2)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             beta3_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(beta3))</span>
<span class="co">##             beta3_c &lt;- sum(t(matrix(beta3)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta4)) {</span>
<span class="co">##             assertthat::assert_that(is.null(c_cond))</span>
<span class="co">##             theta4_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(!is.null(c_cond))</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta4))</span>
<span class="co">##             theta4_c &lt;- sum(t(matrix(theta4)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             theta5_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta5))</span>
<span class="co">##             theta5_c &lt;- sum(t(matrix(theta5)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             theta6_c &lt;- 0</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             assertthat::assert_that(length(c_cond) == length(theta6))</span>
<span class="co">##             theta6_c &lt;- sum(t(matrix(theta6)) %*% matrix(c_cond))</span>
<span class="co">##         }</span>
<span class="co">##         expit &lt;- function(x) {</span>
<span class="co">##             exp(x)/(1 + exp(x))</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pd_cde_theta5 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pd_cde_theta5 &lt;- c_cond</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_cde &lt;- matrix(c(0, 0, rep(0, length(beta2)), rep(0, </span>
<span class="co">##             length(beta3)), 0, (a1 - a0), 0, (a1 - a0) * m_cde, </span>
<span class="co">##             rep(0, length(theta4)), pd_cde_theta5, rep(0, length(theta6))))</span>
<span class="co">##         pnde_expit_a1 &lt;- expit(a0 * (beta1 + beta3_c) + a1 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         pnde_expit_a0 &lt;- expit(a0 * (beta1 + beta3_c) + a0 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         pnde_d1 &lt;- pnde_expit_a1 - pnde_expit_a0</span>
<span class="co">##         pnde_d2 &lt;- a0 * pnde_d1</span>
<span class="co">##         pnde_d3 &lt;- c_cond * pnde_d1</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pnde_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnde_d4 &lt;- c_cond * a0 * pnde_d1</span>
<span class="co">##         }</span>
<span class="co">##         pnde_d5 &lt;- 0</span>
<span class="co">##         pnde_d6 &lt;- a1 - a0</span>
<span class="co">##         pnde_d7 &lt;- pnde_d1</span>
<span class="co">##         pnde_d8 &lt;- a1 * pnde_expit_a1 - a0 * pnde_expit_a0</span>
<span class="co">##         pnde_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             pnde_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnde_d10 &lt;- c_cond * (a1 - a0)</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pnde_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnde_d11 &lt;- c_cond * pnde_d1</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnde &lt;- matrix(c(pnde_d1, pnde_d2, pnde_d3, pnde_d4, </span>
<span class="co">##             pnde_d5, pnde_d6, pnde_d7, pnde_d8, pnde_d9, pnde_d10, </span>
<span class="co">##             pnde_d11))</span>
<span class="co">##         tnie_expit_q1 &lt;- expit(a0 * (beta1 + beta3_c) + beta0 + </span>
<span class="co">##             beta2_c)</span>
<span class="co">##         tnie_expit_q2 &lt;- expit(a0 * (beta1 + beta3_c) + a1 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         tnie_expit_q3 &lt;- expit(a1 * (beta1 + beta3_c) + beta0 + </span>
<span class="co">##             beta2_c)</span>
<span class="co">##         tnie_expit_q4 &lt;- expit(a1 * (beta1 + beta3_c) + a1 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         tnie_d1 &lt;- tnie_expit_q1 - tnie_expit_q2 - tnie_expit_q3 + </span>
<span class="co">##             tnie_expit_q4</span>
<span class="co">##         tnie_d2 &lt;- a0 * (tnie_expit_q1 - tnie_expit_q2) + a1 * </span>
<span class="co">##             (-tnie_expit_q3 + tnie_expit_q4)</span>
<span class="co">##         tnie_d3 &lt;- c_cond * tnie_d1</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             tnie_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnie_d4 &lt;- c_cond * tnie_d2</span>
<span class="co">##         }</span>
<span class="co">##         tnie_d5 &lt;- 0</span>
<span class="co">##         tnie_d6 &lt;- 0</span>
<span class="co">##         tnie_d7 &lt;- tnie_expit_q4 - tnie_expit_q2</span>
<span class="co">##         tnie_d8 &lt;- a1 * tnie_d7</span>
<span class="co">##         tnie_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         tnie_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             tnie_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnie_d11 &lt;- c_cond * tnie_d7</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnie &lt;- matrix(c(tnie_d1, tnie_d2, tnie_d3, tnie_d4, </span>
<span class="co">##             tnie_d5, tnie_d6, tnie_d7, tnie_d8, tnie_d9, tnie_d10, </span>
<span class="co">##             tnie_d11))</span>
<span class="co">##         tnde_expit_a1 &lt;- expit(a1 * (beta1 + beta3_c) + a1 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         tnde_expit_a0 &lt;- expit(a1 * (beta1 + beta3_c) + a0 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         tnde_d1 &lt;- tnde_expit_a1 - tnde_expit_a0</span>
<span class="co">##         tnde_d2 &lt;- a1 * tnde_d1</span>
<span class="co">##         tnde_d3 &lt;- c_cond * tnde_d1</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             tnde_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnde_d4 &lt;- c_cond * a1 * tnde_d1</span>
<span class="co">##         }</span>
<span class="co">##         tnde_d5 &lt;- 0</span>
<span class="co">##         tnde_d6 &lt;- a1 - a0</span>
<span class="co">##         tnde_d7 &lt;- tnde_d1</span>
<span class="co">##         tnde_d8 &lt;- a1 * tnde_expit_a1 - a0 * tnde_expit_a0</span>
<span class="co">##         tnde_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         if (is.null(theta5)) {</span>
<span class="co">##             tnde_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnde_d10 &lt;- c_cond * (a1 - a0)</span>
<span class="co">##         }</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             tnde_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             tnde_d11 &lt;- tnde_d3</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_tnde &lt;- matrix(c(tnde_d1, tnde_d2, tnde_d3, tnde_d4, </span>
<span class="co">##             tnde_d5, tnde_d6, tnde_d7, tnde_d8, tnde_d9, tnde_d10, </span>
<span class="co">##             tnde_d11))</span>
<span class="co">##         pnie_expit_q1 &lt;- expit(a0 * (beta1 + beta3_c) + beta0 + </span>
<span class="co">##             beta2_c)</span>
<span class="co">##         pnie_expit_q2 &lt;- expit(a0 * (beta1 + beta3_c) + a0 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         pnie_expit_q3 &lt;- expit(a1 * (beta1 + beta3_c) + beta0 + </span>
<span class="co">##             beta2_c)</span>
<span class="co">##         pnie_expit_q4 &lt;- expit(a1 * (beta1 + beta3_c) + a0 * </span>
<span class="co">##             theta3 + beta0 + beta2_c + theta6_c + theta2)</span>
<span class="co">##         pnie_d1 &lt;- pnie_expit_q1 - pnie_expit_q2 - pnie_expit_q3 + </span>
<span class="co">##             pnie_expit_q4</span>
<span class="co">##         pnie_d2 &lt;- a0 * (pnie_expit_q1 - pnie_expit_q2) + a1 * </span>
<span class="co">##             (-pnie_expit_q3 + pnie_expit_q4)</span>
<span class="co">##         pnie_d3 &lt;- c_cond * pnie_d1</span>
<span class="co">##         if (is.null(beta3)) {</span>
<span class="co">##             pnie_d4 &lt;- rep(0, length(beta3))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnie_d4 &lt;- c_cond * pnie_d2</span>
<span class="co">##         }</span>
<span class="co">##         pnie_d5 &lt;- 0</span>
<span class="co">##         pnie_d6 &lt;- 0</span>
<span class="co">##         pnie_d7 &lt;- pnie_expit_q4 - pnie_expit_q2</span>
<span class="co">##         pnie_d8 &lt;- a0 * pnie_d7</span>
<span class="co">##         pnie_d9 &lt;- rep(0, length(theta4))</span>
<span class="co">##         pnie_d10 &lt;- rep(0, length(theta5))</span>
<span class="co">##         if (is.null(theta6)) {</span>
<span class="co">##             pnie_d11 &lt;- rep(0, length(theta6))</span>
<span class="co">##         }</span>
<span class="co">##         else {</span>
<span class="co">##             pnie_d11 &lt;- c_cond * pnie_d7</span>
<span class="co">##         }</span>
<span class="co">##         Gamma_pnie &lt;- matrix(c(pnie_d1, pnie_d2, pnie_d3, pnie_d4, </span>
<span class="co">##             pnie_d5, pnie_d6, pnie_d7, pnie_d8, pnie_d9, pnie_d10, </span>
<span class="co">##             pnie_d11))</span>
<span class="co">##         Gamma_te &lt;- Gamma_pnde + Gamma_tnie</span>
<span class="co">##         pnde &lt;- ((theta1 + theta5_c) * (a1 - a0)) + log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0 + theta2 + theta3 * </span>
<span class="co">##             a1 + theta6_c)) - log(1 + exp(beta0 + beta1 * a0 + </span>
<span class="co">##             beta2_c + beta3_c * a0 + theta2 + theta3 * a0 + theta6_c))</span>
<span class="co">##         tnie &lt;- log(1 + exp(beta0 + beta1 * a1 + beta2_c + beta3_c * </span>
<span class="co">##             a1 + theta2 + theta3 * a1 + theta6_c)) - log(1 + </span>
<span class="co">##             exp(beta0 + beta1 * a0 + beta2_c + beta3_c * a0 + </span>
<span class="co">##                 theta2 + theta3 * a1 + theta6_c)) + log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a0 + beta2_c + beta3_c * a0)) - log(1 + exp(beta0 + </span>
<span class="co">##             beta1 * a1 + beta2_c + beta3_c * a1))</span>
<span class="co">##         d_pm &lt;- grad_prop_med_yreg_logistic(pnde = unname(pnde), </span>
<span class="co">##             tnie = unname(tnie))</span>
<span class="co">##         Gamma_pm &lt;- (d_pm[["pnde"]] * Gamma_pnde) + (d_pm[["tnie"]] * </span>
<span class="co">##             Gamma_tnie)</span>
<span class="co">##         se_cde &lt;- sqrt(as.numeric(t(Gamma_cde) %*% Sigma %*% </span>
<span class="co">##             Gamma_cde))</span>
<span class="co">##         se_pnde &lt;- sqrt(as.numeric(t(Gamma_pnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnde))</span>
<span class="co">##         se_tnie &lt;- sqrt(as.numeric(t(Gamma_tnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnie))</span>
<span class="co">##         se_tnde &lt;- sqrt(as.numeric(t(Gamma_tnde) %*% Sigma %*% </span>
<span class="co">##             Gamma_tnde))</span>
<span class="co">##         se_pnie &lt;- sqrt(as.numeric(t(Gamma_pnie) %*% Sigma %*% </span>
<span class="co">##             Gamma_pnie))</span>
<span class="co">##         se_te &lt;- sqrt(as.numeric(t(Gamma_te) %*% Sigma %*% Gamma_te))</span>
<span class="co">##         se_pm &lt;- sqrt(as.numeric(t(Gamma_pm) %*% Sigma %*% Gamma_pm))</span>
<span class="co">##         c(se_cde = unname(se_cde), se_pnde = unname(se_pnde), </span>
<span class="co">##             se_tnie = unname(se_tnie), se_tnde = unname(se_tnde), </span>
<span class="co">##             se_pnie = unname(se_pnie), se_te = unname(se_te), </span>
<span class="co">##             se_pm = unname(se_pm))</span>
<span class="co">##     }</span>
<span class="co">##     return(fun_se)</span>
<span class="co">## }</span>
<span class="co">## &lt;bytecode: 0x7fbc240f0d70&gt;</span>
<span class="co">## &lt;environment: namespace:regmedint&gt;</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li>V2015: VanderWeele (2015) Explanation in Causal Inference</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kazuki Yoshida, Yi Li.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
