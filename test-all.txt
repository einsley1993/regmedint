✔ |  OK F W S | Context
⠏ |   0       | 01_regmedint_class_ui✔ |   0       | 01_regmedint_class_ui
⠏ |   0       | 03_fit_mreg✔ |  24       | 03_fit_mreg
⠏ |   0       | 03_helpers_fit_mreg_fit_yreg✔ |  23       | 03_helpers_fit_mreg_fit_yreg
⠏ |   0       | 04_fit_yreg_linear✔ |  24       | 04_fit_yreg_linear
⠏ |   0       | 04_fit_yreg_logistic✔ |  24       | 04_fit_yreg_logistic
⠏ |   0       | 04_fit_yreg_negbin⠋ |  21       | 04_fit_yreg_negbin✔ |  24       | 04_fit_yreg_negbin [0.1 s]
⠏ |   0       | 04_fit_yreg_poisson✔ |  24       | 04_fit_yreg_poisson
⠏ |   0       | 04_fit_yreg_survAFT_exp✔ |  24       | 04_fit_yreg_survAFT_exp
⠏ |   0       | 04_fit_yreg_survAFT_weibull✔ |  24       | 04_fit_yreg_survAFT_weibull
⠏ |   0       | 04_fit_yreg_survCox✔ |  24       | 04_fit_yreg_survCox
⠏ |   0       | 06_calc_myreg_helpers_coef⠙ |  42       | 06_calc_myreg_helpers_coef⠋ |  81       | 06_calc_myreg_helpers_coef✔ | 109       | 06_calc_myreg_helpers_coef [0.3 s]
⠏ |   0       | 06_calc_myreg_helpers_vcov⠋ |  31       | 06_calc_myreg_helpers_vcov⠦ |  57       | 06_calc_myreg_helpers_vcov⠼ |  85       | 06_calc_myreg_helpers_vcov⠇ | 109       | 06_calc_myreg_helpers_vcov✔ | 110       | 06_calc_myreg_helpers_vcov [0.4 s]
⠏ |   0       | 07_calc_myreg_mreg_linear_yreg_linear⠙ |  32       | 07_calc_myreg_mreg_linear_yreg_linear⠙ |  72       | 07_calc_myreg_mreg_linear_yreg_linear⠹ | 103       | 07_calc_myreg_mreg_linear_yreg_linear⠇ | 159       | 07_calc_myreg_mreg_linear_yreg_linear⠴ | 186       | 07_calc_myreg_mreg_linear_yreg_linear✔ | 225       | 07_calc_myreg_mreg_linear_yreg_linear [0.6 s]
⠏ |   0       | 07_calc_myreg_mreg_linear_yreg_logistic⠙ |  32       | 07_calc_myreg_mreg_linear_yreg_logistic⠹ |  73       | 07_calc_myreg_mreg_linear_yreg_logistic⠼ | 105       | 07_calc_myreg_mreg_linear_yreg_logistic⠹ | 163       | 07_calc_myreg_mreg_linear_yreg_logistic⠙ | 192       | 07_calc_myreg_mreg_linear_yreg_logistic✔ | 235       | 07_calc_myreg_mreg_linear_yreg_logistic [0.6 s]
⠏ |   0       | 07_calc_myreg_mreg_logistic_yreg_linear⠧ |   8       | 07_calc_myreg_mreg_logistic_yreg_linear⠋ |  11       | 07_calc_myreg_mreg_logistic_yreg_linear⠙ |  52       | 07_calc_myreg_mreg_logistic_yreg_linear⠏ |  90       | 07_calc_myreg_mreg_logistic_yreg_linear⠏ | 130       | 07_calc_myreg_mreg_logistic_yreg_linear⠸ | 164       | 07_calc_myreg_mreg_logistic_yreg_linear⠸ | 214       | 07_calc_myreg_mreg_logistic_yreg_linear✔ | 220       | 07_calc_myreg_mreg_logistic_yreg_linear [0.9 s]
⠏ |   0       | 07_calc_myreg_mreg_logistic_yreg_logistic⠧ |   8       | 07_calc_myreg_mreg_logistic_yreg_logistic⠋ |  11       | 07_calc_myreg_mreg_logistic_yreg_logistic⠏ |  47 3     | 07_calc_myreg_mreg_logistic_yreg_logistic⠏ |  84 6     | 07_calc_myreg_mreg_logistic_yreg_logistic⠇ | 113 6     | 07_calc_myreg_mreg_logistic_yreg_logistic⠴ | 160 6     | 07_calc_myreg_mreg_logistic_yreg_logistic⠼ | 207 8     | 07_calc_myreg_mreg_logistic_yreg_logistic✖ | 216 9     | 07_calc_myreg_mreg_logistic_yreg_logistic [1.0 s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-07_calc_myreg_mreg_logistic_yreg_logistic.R:232: failure: calc_myreg_mreg_logistic_yreg_logistic logistic no interaction (methodological correctness): returns functions where natural effects do no depend on c_cond
myreg_funs[[1]](1, 2, -3, -1 * c(4, 5, 6)) not equal to myreg_funs[[1]](1, 2, +3, +2 * c(4, 5, 6)).
4/7 mismatches (average diff: 0.0000016)
[3] -0.000000891 - -1.64e-10 == -0.000000891
[5] -0.000000891 - -1.64e-10 == -0.000000891
[6] -0.213653028 - -2.14e-01 == -0.000000891
[7]  0.000003741 -  6.88e-10 ==  0.000003740

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:234: failure: calc_myreg_mreg_logistic_yreg_logistic logistic no interaction (methodological correctness): returns functions where natural effects do no depend on c_cond
myreg_funs[[2]](1, 2, -3, -1 * c(4, 5, 6)) not equal to myreg_funs[[2]](1, 2, +3, +2 * c(4, 5, 6)).
3/7 mismatches (average diff: 0.00000187)
[3] 0.00000279 - 8.35e-10 == 0.0000027912
[5] 0.00000279 - 8.35e-10 == 0.0000027912
[7] 0.04436963 - 4.44e-02 == 0.0000000333

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:269: failure: calc_myreg_mreg_logistic_yreg_logistic logistic no interaction (methodological correctness): returns functions where pm is calculated from natural effects correctly
unname(myreg_funs[[1]](1, 2, 3, c(4, 5, 6))["pm"]) not equal to nie/(nie + nde).
1/1 mismatches
[1] 0.0000444 - 0.0000495 == -0.0000051

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:497: failure: calc_myreg_mreg_logistic_yreg_logistic logistic interaction (methodological correctness): returns functions where nie does not depend on c_cond
myreg_funs[[1]](1, 2, +3, -1 * c(4, 5, 6))["tnie"] not equal to myreg_funs[[1]](1, 2, +3, +2 * c(4, 5, 6))["tnie"].
1/1 mismatches
[1] -0.00000093 - -1.66e-10 == -0.00000093

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:502: failure: calc_myreg_mreg_logistic_yreg_logistic logistic interaction (methodological correctness): returns functions where nie does not depend on c_cond
myreg_funs[[1]](1, 2, +3, -1 * c(4, 5, 6))["pnie"] not equal to myreg_funs[[1]](1, 2, +3, +2 * c(4, 5, 6))["pnie"].
1/1 mismatches
[1] -0.000000851 - -1.61e-10 == -0.000000851

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:586: failure: calc_myreg_mreg_logistic_yreg_logistic logistic interaction (methodological correctness): returns functions where pm is calculated from natural effects correctly
unname(myreg_funs[[1]](1, 2, 3, c(4, 5, 6))["pm"]) not equal to nie/(nie + nde).
1/1 mismatches
[1] 0.0000512 - 0.0000563 == -0.00000519

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:1080: failure: calc_myreg_mreg_logistic_yreg_logistic_se (NULL cvar): returns a function that gives a numeric vector without NA
all(!is.na(res)) isn't true.

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:1125: failure: calc_myreg_mreg_logistic_yreg_logistic_se (one cvar): returns a function that gives a numeric vector without NA
all(!is.na(res)) isn't true.

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:1170: failure: calc_myreg_mreg_logistic_yreg_logistic_se (three cvar): returns a function that gives a numeric vector without NA
all(!is.na(res)) isn't true.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
⠏ |   0       | 08_regmedint_class_user_methods⠋ |  11       | 08_regmedint_class_user_methods⠹ |  23       | 08_regmedint_class_user_methods⠼ |  28 7     | 08_regmedint_class_user_methods✖ |  32 8     | 08_regmedint_class_user_methods [0.4 s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-08_regmedint_class_user_methods.R:108: failure: summary.regmedint: prints evaluation information
`summary\(fit_regmedint\)` does not match "a1 (intervened value of avar) = ".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nglm\(formula = spiders ~ trt \+ bili, family = binomial\(link = "logit"\), \\n    data = data\)\\n\\nDeviance Residuals: \\n    Min       1Q   Median       3Q      Max  \\n-2\.0340  -0\.7631  -0\.7128   1\.1039   1\.7662  \\n\\nCoefficients:\\n            Estimate Std\. Error z value Pr\(>\|z\|\)    \\n\(Intercept\)  -1\.1071     0\.4392  -2\.521   0\.0117 \*  \\ntrt          -0\.1440     0\.2760  -0\.522   0\.6018    \\nbili          0\.1189     0\.0305   3\.898 0\.000097 \*\*\*\\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\n\(Dispersion parameter for binomial family taken to be 1\)\\n\\n    Null deviance: 332\.32  on 275  degrees of freedom\\nResidual deviance: 314\.69  on 273  degrees of freedom\\nAIC: 320\.69\\n\\nNumber of Fisher Scoring iterations: 4\\n\\n### Mediation analysis \\n             est    SE\(est\)          Z         p\\ncde  -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\ntnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\ntnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\nte   -0\.05566056 0\.28289358 -0\.1967544 0\.8440197\\npm   -1\.47762819 8\.03948961 -0\.1837963 0\.8541733\\nEvaluated at:\\navar: trt\\n a1 \(intervened value of avar\) = 2\\n a0 \(reference value of avar\)  = 1\\nmvar: bili\\n m_cde \(intervend value of mvar for cde\) = 0\\ncvar: \\n c_cond \(covariate vector value\) = \\n\\nNote that effect estimates do not vary over m_cde and c_cond values when interaction = FALSE\."

test-08_regmedint_class_user_methods.R:110: failure: summary.regmedint: prints evaluation information
`summary\(fit_regmedint\)` does not match "a0 (reference value of avar)  = ".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nglm\(formula = spiders ~ trt \+ bili, family = binomial\(link = "logit"\), \\n    data = data\)\\n\\nDeviance Residuals: \\n    Min       1Q   Median       3Q      Max  \\n-2\.0340  -0\.7631  -0\.7128   1\.1039   1\.7662  \\n\\nCoefficients:\\n            Estimate Std\. Error z value Pr\(>\|z\|\)    \\n\(Intercept\)  -1\.1071     0\.4392  -2\.521   0\.0117 \*  \\ntrt          -0\.1440     0\.2760  -0\.522   0\.6018    \\nbili          0\.1189     0\.0305   3\.898 0\.000097 \*\*\*\\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\n\(Dispersion parameter for binomial family taken to be 1\)\\n\\n    Null deviance: 332\.32  on 275  degrees of freedom\\nResidual deviance: 314\.69  on 273  degrees of freedom\\nAIC: 320\.69\\n\\nNumber of Fisher Scoring iterations: 4\\n\\n### Mediation analysis \\n             est    SE\(est\)          Z         p\\ncde  -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\ntnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\ntnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\nte   -0\.05566056 0\.28289358 -0\.1967544 0\.8440197\\npm   -1\.47762819 8\.03948961 -0\.1837963 0\.8541733\\nEvaluated at:\\navar: trt\\n a1 \(intervened value of avar\) = 2\\n a0 \(reference value of avar\)  = 1\\nmvar: bili\\n m_cde \(intervend value of mvar for cde\) = 0\\ncvar: \\n c_cond \(covariate vector value\) = \\n\\nNote that effect estimates do not vary over m_cde and c_cond values when interaction = FALSE\."

test-08_regmedint_class_user_methods.R:112: failure: summary.regmedint: prints evaluation information
`summary\(fit_regmedint\)` does not match "m_cde (intervend value of mvar for cde) = ".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nglm\(formula = spiders ~ trt \+ bili, family = binomial\(link = "logit"\), \\n    data = data\)\\n\\nDeviance Residuals: \\n    Min       1Q   Median       3Q      Max  \\n-2\.0340  -0\.7631  -0\.7128   1\.1039   1\.7662  \\n\\nCoefficients:\\n            Estimate Std\. Error z value Pr\(>\|z\|\)    \\n\(Intercept\)  -1\.1071     0\.4392  -2\.521   0\.0117 \*  \\ntrt          -0\.1440     0\.2760  -0\.522   0\.6018    \\nbili          0\.1189     0\.0305   3\.898 0\.000097 \*\*\*\\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\n\(Dispersion parameter for binomial family taken to be 1\)\\n\\n    Null deviance: 332\.32  on 275  degrees of freedom\\nResidual deviance: 314\.69  on 273  degrees of freedom\\nAIC: 320\.69\\n\\nNumber of Fisher Scoring iterations: 4\\n\\n### Mediation analysis \\n             est    SE\(est\)          Z         p\\ncde  -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\ntnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\ntnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\nte   -0\.05566056 0\.28289358 -0\.1967544 0\.8440197\\npm   -1\.47762819 8\.03948961 -0\.1837963 0\.8541733\\nEvaluated at:\\navar: trt\\n a1 \(intervened value of avar\) = 2\\n a0 \(reference value of avar\)  = 1\\nmvar: bili\\n m_cde \(intervend value of mvar for cde\) = 0\\ncvar: \\n c_cond \(covariate vector value\) = \\n\\nNote that effect estimates do not vary over m_cde and c_cond values when interaction = FALSE\."

test-08_regmedint_class_user_methods.R:114: failure: summary.regmedint: prints evaluation information
`summary\(fit_regmedint\)` does not match "c_cond (covariate vector value) =".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nglm\(formula = spiders ~ trt \+ bili, family = binomial\(link = "logit"\), \\n    data = data\)\\n\\nDeviance Residuals: \\n    Min       1Q   Median       3Q      Max  \\n-2\.0340  -0\.7631  -0\.7128   1\.1039   1\.7662  \\n\\nCoefficients:\\n            Estimate Std\. Error z value Pr\(>\|z\|\)    \\n\(Intercept\)  -1\.1071     0\.4392  -2\.521   0\.0117 \*  \\ntrt          -0\.1440     0\.2760  -0\.522   0\.6018    \\nbili          0\.1189     0\.0305   3\.898 0\.000097 \*\*\*\\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\n\(Dispersion parameter for binomial family taken to be 1\)\\n\\n    Null deviance: 332\.32  on 275  degrees of freedom\\nResidual deviance: 314\.69  on 273  degrees of freedom\\nAIC: 320\.69\\n\\nNumber of Fisher Scoring iterations: 4\\n\\n### Mediation analysis \\n             est    SE\(est\)          Z         p\\ncde  -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\ntnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\ntnde -0\.14403023 0\.27604401 -0\.5217655 0\.6018336\\npnie  0\.08836967 0\.06955445  1\.2705108 0\.2039028\\nte   -0\.05566056 0\.28289358 -0\.1967544 0\.8440197\\npm   -1\.47762819 8\.03948961 -0\.1837963 0\.8541733\\nEvaluated at:\\navar: trt\\n a1 \(intervened value of avar\) = 2\\n a0 \(reference value of avar\)  = 1\\nmvar: bili\\n m_cde \(intervend value of mvar for cde\) = 0\\ncvar: \\n c_cond \(covariate vector value\) = \\n\\nNote that effect estimates do not vary over m_cde and c_cond values when interaction = FALSE\."

test-08_regmedint_class_user_methods.R:123: failure: summary.regmedint: returns an object with appropriate columns
colnames(summary_out) not equal to c("est", "se", "Z", "p", "lower", "upper").
Lengths differ: 4 is not 6

test-08_regmedint_class_user_methods.R:125: error: summary.regmedint: returns an object with appropriate columns
$ operator is invalid for atomic vectors
Backtrace:
 1. testthat::expect_equal(summary_out$est, coef(fit_regmedint)) tests/testthat/test-08_regmedint_class_user_methods.R:125:16
 2. testthat::quasi_label(enquo(object), label, arg = "object")
 3. rlang::eval_bare(expr, quo_get_env(quo))

test-08_regmedint_class_user_methods.R:136: failure: summary.regmedint: returns an object with appropriate columns (exponentiated)
colnames(summary_out) not equal to c(...).
Lengths differ: 4 is not 9

test-08_regmedint_class_user_methods.R:139: error: summary.regmedint: returns an object with appropriate columns (exponentiated)
$ operator is invalid for atomic vectors
Backtrace:
 1. testthat::expect_equal(summary_out$est, coef(fit_regmedint)) tests/testthat/test-08_regmedint_class_user_methods.R:139:16
 2. testthat::quasi_label(enquo(object), label, arg = "object")
 3. rlang::eval_bare(expr, quo_get_env(quo))
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
⠏ |   0       | 09_cross_check_with_sas_macro⠙ |   2       | 09_cross_check_with_sas_macro⠙ |  82       | 09_cross_check_with_sas_macro⠇ | 179       | 09_cross_check_with_sas_macro⠴ | 286       | 09_cross_check_with_sas_macro⠙ | 392       | 09_cross_check_with_sas_macro⠧ | 498       | 09_cross_check_with_sas_macro⠙ | 612       | 09_cross_check_with_sas_macro⠹ | 713       | 09_cross_check_with_sas_macro⠦ | 817       | 09_cross_check_with_sas_macro✔ | 913       | 09_cross_check_with_sas_macro [2.4 s]

══ Results ═════════════════════════════════════════════════════════════════════════════════════════════════════════════
Duration: 9.4 s

OK:       2275
Failed:   17
Warnings: 0
Skipped:  0
