✔ |  OK F W S | Context
⠏ |   0       | 01_regmedint_class_ui✔ |   0       | 01_regmedint_class_ui
⠏ |   0       | 03_fit_mreg✔ |  24       | 03_fit_mreg
⠏ |   0       | 03_helpers_fit_mreg_fit_yreg✔ |  23       | 03_helpers_fit_mreg_fit_yreg
⠏ |   0       | 04_fit_yreg_linear✔ |  24       | 04_fit_yreg_linear
⠏ |   0       | 04_fit_yreg_logistic✔ |  24       | 04_fit_yreg_logistic
⠏ |   0       | 04_fit_yreg_poisson✔ |  24       | 04_fit_yreg_poisson
⠏ |   0       | 04_fit_yreg_survAFT_exp✔ |  24       | 04_fit_yreg_survAFT_exp
⠏ |   0       | 04_fit_yreg_survAFT_weibull✔ |  24       | 04_fit_yreg_survAFT_weibull
⠏ |   0       | 06_calc_myreg_helpers_coef⠸ |  44       | 06_calc_myreg_helpers_coef⠸ |  84       | 06_calc_myreg_helpers_coef✔ | 109       | 06_calc_myreg_helpers_coef [0.3 s]
⠏ |   0       | 06_calc_myreg_helpers_vcov⠋ |  31       | 06_calc_myreg_helpers_vcov⠦ |  57       | 06_calc_myreg_helpers_vcov⠼ |  85       | 06_calc_myreg_helpers_vcov⠇ | 109       | 06_calc_myreg_helpers_vcov✔ | 110       | 06_calc_myreg_helpers_vcov [0.4 s]
⠏ |   0       | 07_calc_myreg_mreg_linear_yreg_linear✔ |   0     2 | 07_calc_myreg_mreg_linear_yreg_linear
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-07_calc_myreg_mreg_linear_yreg_linear.R:17: skip: calc_myreg_mreg_linear_yreg_linear_est works given coef
Reason: empty test

test-07_calc_myreg_mreg_linear_yreg_linear.R:26: skip: calc_myreg_mreg_linear_yreg_linear_se works given coef and vcov
Reason: empty test
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
⠏ |   0       | 07_calc_myreg_mreg_linear_yreg_logistic⠇ |  49       | 07_calc_myreg_mreg_linear_yreg_logistic⠼ |  95       | 07_calc_myreg_mreg_linear_yreg_logistic⠦ | 157       | 07_calc_myreg_mreg_linear_yreg_logistic⠏ | 209 1     | 07_calc_myreg_mreg_linear_yreg_logistic✖ | 232 3     | 07_calc_myreg_mreg_linear_yreg_logistic [0.4 s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-07_calc_myreg_mreg_linear_yreg_logistic.R:1184: failure: calc_myreg_mreg_linear_yreg_logistic_se (NULL cvar): returns a function that gives a numeric vector without NA
all(!is.na(res)) isn't true.

test-07_calc_myreg_mreg_linear_yreg_logistic.R:1232: failure: calc_myreg_mreg_linear_yreg_logistic_se (one cvar): returns a function that gives a numeric vector without NA
all(!is.na(res)) isn't true.

test-07_calc_myreg_mreg_linear_yreg_logistic.R:1280: failure: calc_myreg_mreg_linear_yreg_logistic_se (three cvar): returns a function that gives a numeric vector without NA
all(!is.na(res)) isn't true.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
⠏ |   0       | 07_calc_myreg_mreg_logistic_yreg_linear✔ |   0     2 | 07_calc_myreg_mreg_logistic_yreg_linear
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-07_calc_myreg_mreg_logistic_yreg_linear.R:17: skip: calc_myreg_mreg_logistic_yreg_linear_est works given coef
Reason: empty test

test-07_calc_myreg_mreg_logistic_yreg_linear.R:26: skip: calc_myreg_mreg_logistic_yreg_linear_se works given coef and vcov
Reason: empty test
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
⠏ |   0       | 07_calc_myreg_mreg_logistic_yreg_logistic✔ |   0     2 | 07_calc_myreg_mreg_logistic_yreg_logistic
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-07_calc_myreg_mreg_logistic_yreg_logistic.R:17: skip: calc_myreg_mreg_logistic_yreg_logistic_est works given coef
Reason: empty test

test-07_calc_myreg_mreg_logistic_yreg_logistic.R:26: skip: calc_myreg_mreg_logistic_yreg_logistic_se works given coef and vcov
Reason: empty test
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
⠏ |   0       | 08_regmedint_class_user_methods⠹ |   9 4     | 08_regmedint_class_user_methods⠧ |  24 4     | 08_regmedint_class_user_methods⠸ |  36 8     | 08_regmedint_class_user_methods✖ |  49 9     | 08_regmedint_class_user_methods [0.4 s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
test-08_regmedint_class_user_methods.R:39: failure: print.regmedint: prints the mreg results
`print\(fit_regmedint\)` does not match "lm(formula = bili ~ trt, data = data)".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nCoefficients:\\n\(Intercept\)          trt  \\n     2\.2132       0\.7434  \\n\\n### Outcome model\\n\\nCall:\\nlm\(formula = alk\.phos ~ trt \+ bili, data = data\)\\n\\nCoefficients:\\n\(Intercept\)          trt         bili  \\n    1913\.49       -87\.70        64\.58  \\n\\n### Mediation analysis \\n       cde       pnde       tnie       tnde       pnie         te         pm \\n-87\.700481 -87\.700481  48\.010649 -87\.700481  48\.010649 -39\.689832  -1\.209646 "

test-08_regmedint_class_user_methods.R:43: failure: print.regmedint: prints the yreg results
`print\(fit_regmedint\)` does not match "lm(formula = alk.phos ~ trt + bili, data = data)".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nCoefficients:\\n\(Intercept\)          trt  \\n     2\.2132       0\.7434  \\n\\n### Outcome model\\n\\nCall:\\nlm\(formula = alk\.phos ~ trt \+ bili, data = data\)\\n\\nCoefficients:\\n\(Intercept\)          trt         bili  \\n    1913\.49       -87\.70        64\.58  \\n\\n### Mediation analysis \\n       cde       pnde       tnie       tnde       pnie         te         pm \\n-87\.700481 -87\.700481  48\.010649 -87\.700481  48\.010649 -39\.689832  -1\.209646 "

test-08_regmedint_class_user_methods.R:59: failure: summary.regmedint: prints the mreg results
`print\(summary\(fit_regmedint\)\)` does not match "lm(formula = bili ~ trt, data = data)".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nlm\(formula = alk\.phos ~ trt \+ bili, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-2276\.8 -1030\.7  -655\.3   -12\.5 12053\.3 \\n\\nCoefficients:\\n            Estimate Std\. Error t value   Pr\(>\|t\|\)    \\n\(Intercept\)  1913\.49     406\.56   4\.707 0\.00000401 \*\*\*\\ntrt           -87\.70     253\.94  -0\.345     0\.7301    \\nbili           64\.58      27\.64   2\.336     0\.0202 \*  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 2102 on 273 degrees of freedom\\nMultiple R-squared:  0\.01969,\\tAdjusted R-squared:  0\.01251 \\nF-statistic: 2\.742 on 2 and 273 DF,  p-value: 0\.06624\\n\\n### Mediation analysis \\n            est    SE\(est\)          Z         p\\ncde  -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\ntnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\ntnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\nte   -39\.689832 255\.611196 -0\.1552742 0\.4383026\\npm    -1\.209646   7\.914485 -0\.1528395 0\.4392624\\nattr\(,"args"\)\\nattr\(,"args"\)\$a0\\n\[1\] 1\\n\\nattr\(,"args"\)\$a1\\n\[1\] 2\\n\\nattr\(,"args"\)\$m_cde\\n\[1\] 0\\n\\nattr\(,"args"\)\$c_cond\\nNULL\\n\\n            est    SE\(est\)          Z         p\\ncde  -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\ntnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\ntnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\nte   -39\.689832 255\.611196 -0\.1552742 0\.4383026\\npm    -1\.209646   7\.914485 -0\.1528395 0\.4392624\\nattr\(,"args"\)\\nattr\(,"args"\)\$a0\\n\[1\] 1\\n\\nattr\(,"args"\)\$a1\\n\[1\] 2\\n\\nattr\(,"args"\)\$m_cde\\n\[1\] 0\\n\\nattr\(,"args"\)\$c_cond\\nNULL\\n"

test-08_regmedint_class_user_methods.R:63: failure: summary.regmedint: prints the yreg results
`print\(summary\(fit_regmedint\)\)` does not match "lm(formula = alk.phos ~ trt + bili, data = data)".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nlm\(formula = alk\.phos ~ trt \+ bili, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-2276\.8 -1030\.7  -655\.3   -12\.5 12053\.3 \\n\\nCoefficients:\\n            Estimate Std\. Error t value   Pr\(>\|t\|\)    \\n\(Intercept\)  1913\.49     406\.56   4\.707 0\.00000401 \*\*\*\\ntrt           -87\.70     253\.94  -0\.345     0\.7301    \\nbili           64\.58      27\.64   2\.336     0\.0202 \*  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 2102 on 273 degrees of freedom\\nMultiple R-squared:  0\.01969,\\tAdjusted R-squared:  0\.01251 \\nF-statistic: 2\.742 on 2 and 273 DF,  p-value: 0\.06624\\n\\n### Mediation analysis \\n            est    SE\(est\)          Z         p\\ncde  -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\ntnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\ntnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\nte   -39\.689832 255\.611196 -0\.1552742 0\.4383026\\npm    -1\.209646   7\.914485 -0\.1528395 0\.4392624\\nattr\(,"args"\)\\nattr\(,"args"\)\$a0\\n\[1\] 1\\n\\nattr\(,"args"\)\$a1\\n\[1\] 2\\n\\nattr\(,"args"\)\$m_cde\\n\[1\] 0\\n\\nattr\(,"args"\)\$c_cond\\nNULL\\n\\n            est    SE\(est\)          Z         p\\ncde  -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\ntnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\ntnde -87\.700481 253\.935185 -0\.3453656 0\.3649098\\npnie  48\.010649  41\.213102  1\.1649366 0\.8779777\\nte   -39\.689832 255\.611196 -0\.1552742 0\.4383026\\npm    -1\.209646   7\.914485 -0\.1528395 0\.4392624\\nattr\(,"args"\)\\nattr\(,"args"\)\$a0\\n\[1\] 1\\n\\nattr\(,"args"\)\$a1\\n\[1\] 2\\n\\nattr\(,"args"\)\$m_cde\\n\[1\] 0\\n\\nattr\(,"args"\)\$c_cond\\nNULL\\n"

test-08_regmedint_class_user_methods.R:125: failure: print.regmedint: prints the mreg results
`print\(fit_regmedint\)` does not match "lm(formula = bili ~ trt, data = data)".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nCoefficients:\\n\(Intercept\)          trt  \\n     2\.2132       0\.7434  \\n\\n### Outcome model\\n\\nCall:  glm\(formula = spiders ~ trt \+ bili, family = binomial\(link = "logit"\), \\n    data = data\)\\n\\nCoefficients:\\n\(Intercept\)          trt         bili  \\n    -1\.1071      -0\.1440       0\.1189  \\n\\nDegrees of Freedom: 275 Total \(i\.e\. Null\);  273 Residual\\nNull Deviance:\\t    332\.3 \\nResidual Deviance: 314\.7 \\tAIC: 320\.7\\n### Mediation analysis \\n        cde        pnde        tnie        tnde        pnie          te \\n-0\.14403023 -0\.14403023  0\.08836967 -0\.14403023  0\.08836967 -0\.05566056 \\n         pm \\n-1\.47762819 "

test-08_regmedint_class_user_methods.R:129: error: print.regmedint: prints the yreg results
invalid regular expression 'glm(formula = spiders ~ trt + bili, family = binomial(link = "logit"), ', reason 'Missing ')''
Backtrace:
 1. testthat::expect_output(print(fit_regmedint), deparse(fit_regmedint$yreg$call)[1]) tests/testthat/test-08_regmedint_class_user_methods.R:129:16
 2. testthat::expect_match(...)
 3. base::grepl(regexp, act$val, perl = perl, fixed = fixed, ...)

test-08_regmedint_class_user_methods.R:145: failure: summary.regmedint: prints the mreg results
`print\(summary\(fit_regmedint\)\)` does not match "lm(formula = bili ~ trt, data = data)".
Actual value: "### Mediator model\\n\\nCall:\\nlm\(formula = bili ~ trt, data = data\)\\n\\nResiduals:\\n    Min      1Q  Median      3Q     Max \\n-3\.4000 -2\.5000 -1\.7000  0\.4434 24\.3000 \\n\\nCoefficients:\\n            Estimate Std\. Error t value Pr\(>\|t\|\)  \\n\(Intercept\)   2\.2132     0\.8784   2\.520   0\.0123 \*\\ntrt           0\.7434     0\.5532   1\.344   0\.1801  \\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\nResidual standard error: 4\.594 on 274 degrees of freedom\\nMultiple R-squared:  0\.006548,\\tAdjusted R-squared:  0\.002923 \\nF-statistic: 1\.806 on 1 and 274 DF,  p-value: 0\.1801\\n\\n### Outcome model\\n\\nCall:\\nglm\(formula = spiders ~ trt \+ bili, family = binomial\(link = "logit"\), \\n    data = data\)\\n\\nDeviance Residuals: \\n    Min       1Q   Median       3Q      Max  \\n-2\.0340  -0\.7631  -0\.7128   1\.1039   1\.7662  \\n\\nCoefficients:\\n            Estimate Std\. Error z value Pr\(>\|z\|\)    \\n\(Intercept\)  -1\.1071     0\.4392  -2\.521   0\.0117 \*  \\ntrt          -0\.1440     0\.2760  -0\.522   0\.6018    \\nbili          0\.1189     0\.0305   3\.898 0\.000097 \*\*\*\\n---\\nSignif\. codes:  0 '\*\*\*' 0\.001 '\*\*' 0\.01 '\*' 0\.05 '\.' 0\.1 ' ' 1\\n\\n\(Dispersion parameter for binomial family taken to be 1\)\\n\\n    Null deviance: 332\.32  on 275  degrees of freedom\\nResidual deviance: 314\.69  on 273  degrees of freedom\\nAIC: 320\.69\\n\\nNumber of Fisher Scoring iterations: 4\\n\\n### Mediation analysis \\n             est    SE\(est\)          Z         p\\ncde  -0\.14403023 0\.27604401 -0\.5217655 0\.3009168\\npnde -0\.14403023 0\.27604401 -0\.5217655 0\.3009168\\ntnie  0\.08836967 0\.06955445  1\.2705108 0\.8980486\\ntnde -0\.14403023 0\.27604401 -0\.5217655 0\.3009168\\npnie  0\.08836967 0\.06955445  1\.2705108 0\.8980486\\nte   -0\.05566056 0\.28289358 -0\.1967544 0\.4220099\\npm   -1\.47762819         NA         NA        NA\\nattr\(,"args"\)\\nattr\(,"args"\)\$a0\\n\[1\] 1\\n\\nattr\(,"args"\)\$a1\\n\[1\] 2\\n\\nattr\(,"args"\)\$m_cde\\n\[1\] 0\\n\\nattr\(,"args"\)\$c_cond\\nNULL\\n\\n             est    SE\(est\)          Z         p\\ncde  -0\.14403023 0\.27604401 -0\.5217655 0\.3009168\\npnde -0\.14403023 0\.27604401 -0\.5217655 0\.3009168\\ntnie  0\.08836967 0\.06955445  1\.2705108 0\.8980486\\ntnde -0\.14403023 0\.27604401 -0\.5217655 0\.3009168\\npnie  0\.08836967 0\.06955445  1\.2705108 0\.8980486\\nte   -0\.05566056 0\.28289358 -0\.1967544 0\.4220099\\npm   -1\.47762819         NA         NA        NA\\nattr\(,"args"\)\\nattr\(,"args"\)\$a0\\n\[1\] 1\\n\\nattr\(,"args"\)\$a1\\n\[1\] 2\\n\\nattr\(,"args"\)\$m_cde\\n\[1\] 0\\n\\nattr\(,"args"\)\$c_cond\\nNULL\\n"

test-08_regmedint_class_user_methods.R:149: error: summary.regmedint: prints the yreg results
invalid regular expression 'glm(formula = spiders ~ trt + bili, family = binomial(link = "logit"), ', reason 'Missing ')''
Backtrace:
 1. testthat::expect_output(print(summary(fit_regmedint)), deparse(fit_regmedint$yreg$call)[1]) tests/testthat/test-08_regmedint_class_user_methods.R:149:16
 2. testthat::expect_match(...)
 3. base::grepl(regexp, act$val, perl = perl, fixed = fixed, ...)

test-08_regmedint_class_user_methods.R:187: failure: confint.regmedint: creates the lower column less than the upper column
all(...) isn't true.
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

══ Results ═════════════════════════════════════════════════════════════════════════════════════════════════════════════
Duration: 3.9 s

OK:       667
Failed:   12
Warnings: 0
Skipped:  6

Don't worry, you'll get it.
